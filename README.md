# Panda 熊猫烧香的C++版本实现

该工程是熊猫烧香病毒的c++参考实现，主要参考网络广为流传的delphi版本，和病毒发作当时的版本应该还是还是有比较大的差距

## 主要技术点
流传的delphi版本没有提供漏洞利用方面的实现，这里提供的版本也没有作过多深入，仅供参考，主要涉及以下技术点
（1）远程注入技术，CreateRemoteThread
（2）遍历磁盘感染所有的执行文件，并进行感染
（3）被感染文件启动后，实际上启动的就是一个病毒程序，同时分离出原宿主文件运行

## 主要工程
（1）Inject 是一个动态库，编译的输出结果为 Inject.dll 动态库，主要是注入使用
（2）MFCApplication1 一个原生的MFC程序，没添加任何代码，编译输出为 MFCApplication1.exe
（3）Project1 也就是主要的熊猫烧香病毒样本实现，编译结果输出 Japussy.exe
（4）Rouji 一个常驻进程，可以认为就是事实上的explorer进程，熊猫启动的时候会注入到explorer中

## 注意点
本版本基于win10+vs2022开发，测试基于win10机器，未在其他机器做测试，如果需要调试注意
（1）程序中的一些路径配置需要调整为本地正常路径，如我的开发路径为`D:\develop\Project1\`
（2）工程文件夹原命名为`Project1`，提交到github存储到了仓库`Panda`
（3）`InfectOneFile`函数中加了判断，只会影响`MFCAPPLICATION1.EXE`程序，调试确认是否需要调整
（4）`HeaderSize`大小以本地编译的结果为准，请根据实际调整
（5）本实现未使用`IconOffset`相关的参考，感染的目标文件为病毒文件和宿主文件的二进制合并